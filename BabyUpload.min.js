!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.BabyUpload=e()}(this,function(){"use strict";var t=function(){},s={isChangeUpload:!1,name:"file",multiple:!1,data:{},method:"POST",accept:"",withCredentials:!1,change:t,beforeUpload:t,success:t,error:t};function o(t){if(!(this instanceof o))return new o(t);t=function(t){for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e]||{};for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];void 0!==o&&(t[s]=o)}}return t}(s,t);var i=this,e="string"==typeof t.el?document.querySelector(t.el):t.el;this.options=t,this.files=[];var n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("name","file"),this.options.multiple&&n.setAttribute("multiple","multiple"),this.options.accept&&n.setAttribute("accept",this.options.accept),n.style.display="none",document.body.appendChild(n),e.addEventListener("click",function(t){n.value="",n.click()},!1),n.addEventListener("change",function(t){var e=Array.prototype.slice.call(this.files);i.options.multiple?i.files=i.files.concat(e):i.files=e,i.options.change(e,i.files),i.options.isChangeUpload&&i.upload()},!1)}function h(e){try{return JSON.parse(e)}catch(t){return{data:e}}}return o.prototype.upload=function(){if(this.options.beforeUpload(this.files),!this.files.length)return!1;for(var s=this.options.url,o=this.options.method,r=this.options.success,a=this.options.error,l=this,p=[],f=0,c=this.files.length;f<this.files.length;f++){this.files[f];!function(t){var e=new FormData;for(var i in e.append(l.options.name,l.files[f]),l.options.data)e.append(i,l.options.data[i]);var n=new XMLHttpRequest;n.open(o,s,!0),n.withCredentials=l.options.withCredentials,n.onreadystatechange=function(){200==this.status?4==this.readyState&&(c-=1,p.push(h(this.responseText)),0===c&&r&&r(p)):a&&a(h(this.responseText))},n.send(e)}()}this.files=[]},o.prototype.remove=function(t){this.files.length&&(t=void 0===t?0:t,console.log(this.files),this.files.splice(t,1))},o});